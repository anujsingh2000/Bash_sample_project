# Script to do health-check of url and print their status
## list of urls

url_list=( "https://www.glassdoor.in" "https://www.flipkart.com" "https://naukri.com" "https://www.gfg.com" )

declare -A failed_url_list 

echo "Checking urls..."

#Check each url using curl command
for url in ${url_list[@]}; do

# using curl to get status code(silent,no output,only status code)
status_code=$(curl -s -o /dev/null -w "%{http_code}" -f --connect-timeout 5 "${url}" 2>/dev/null) || status_code=0

#Checking site status based on response code
if [[ ${status_code} -eq 200 ]]; then
  echo "${url} is working correctly"
else
  ##
  if [[ ${status_code} -eq 0 ]];then
    failed_url_list["${url}"]="Unreachable"   #Associative array, so storing value in key-value pair
  else
    failed_url_list["$url"]="HTTP $status_code"
  fi
fi
done

echo 
echo "----------------------"
echo "Summary of failed urls"

if [ "${#failed_url_list[@]}" -eq 0 ]; then
  echo "All urls are working correctly"
else
  for i in "${!failed_url_list[@]}"; do
      echo "$i : ${failed_url_list[$i]}"
  done
fi

